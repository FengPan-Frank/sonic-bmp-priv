pr: none
trigger: none

schedules:
- cron: "0 0 * * *"
  displayName: Daily
  always: true
  branches:
    include:
    - master

jobs:
- job: build
  timeoutInMinutes: 240
  pool: sonicbld

  container:
    image: sonicdev-microsoft.azurecr.io:443/${{ parameters.sonic_slave }}:latest

  steps:
    - checkout: none
    - bash: |
      set -ex
      git clone https://github.com/edenhill/librdkafka.git
      cd librdkafka
      ./configure
      make
      sudo make install

      git clone https://github.com/jbeder/yaml-cpp.git
      cd yaml-cpp
      mkdir build
      cd build
      cmake -DBUILD_SHARED_LIBS=OFF ..
      make
      sudo make install

      sudo apt-get install gcc g++ libboost-dev cmake zlib1g-dev libssl1.0.0 libsasl2-2 libssl-dev libsasl2-dev 

      git clone https://github.com/FengPan-Frank/sonic-bmp.git
      cd sonic-bmp
      mkdir build
      cd build
      cmake -DCMAKE_INSTALL_PREFIX:PATH=/usr ../  
      make